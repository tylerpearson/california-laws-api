
<!DOCTYPE html><html><head><meta charset="utf-8">
<title>API for California State Code</title>

<style>

body {
    padding: 30px;
    font-family: "Avenir Next", "Helvetica Neue", sans-serif!important;
}

p, li {
    line-height: 1.66;
}

a {
    color: #3392c4;
}


</style>


</head>
<body>
<h1 id="api-for-california-state-code">JSON API for California State Code</h1>
<p>This is an API for the California state code that is available as JSON. Currently the state of California makes it difficult to access the laws programmatically <a href="https://github.com/tylerpearson/state-code-scrapers/blob/master/ca/scrape.rb">(here is a first pass at scraping to get the data)</a>, so this is an attempt at making that easier.</p>
<p>IANAL, so if you have ideas on adjusting the API structure to better match the structure of state code and make it easier to use, please feel free to add an issue.</p>
<h2 id="endpoints">Endpoints</h2>
<h3 id="codes">Codes</h3>
<p>A list of codes is available at <a href="https://api.calilaws.com/v1/codes">https://api.calilaws.com/v1/codes</a></p>
<h3 id="sections">Sections</h3>
<p>A list of sections of state code is available at <a href="https://api.calilaws.com/v1/sections">https://api.calilaws.com/v1/sections</a>.</p>
<p>The laws can be filtered by <code>code</code>, <code>division</code>, <code>chapter</code>, and <code>article</code> by passing it along as parameters in the URL. An example would be <a href="https://api.calilaws.com/v1/sections?code=ELEC&amp;division=1">https://api.calilaws.com/v1/sections?code=ELEC&amp;division=1</a>. There is information on pagination in <code>meta</code> in the JSON response.</p>
<p>For a direct link to the JSON for a law, pass the id in the URL. For example <a href="https://api.calilaws.com/v1/sections/ELEC1500.20048177">https://api.calilaws.com/v1/sections/ELEC1500.20048177</a></p>
<h3 id="search">Search</h3>
<p>Search the state code with <code>https://api.calilaws.com/v1/search/&lt;search term&gt;</code>. For example <a href="https://api.calilaws.com/v1/search/landlord">https://api.calilaws.com/v1/search/landlord</a>. The search is setup with Elasticsearch.</p>
<h2 id="database-setup">Database setup</h2>
<h3 id="locally">Locally</h3>
<p>There is a MySQL database of California state codes available through FTP at ftp://www.leginfo.ca.gov/pub/bill/. Inside the directory are <a href="https://s3.amazonaws.com/cali-laws/pubinfo_Readme.pdf">instructions on importing the tables</a> that are needed.</p>
<p>Here&#39;s a <a href="https://s3.amazonaws.com/cali-laws/calaws.mysql">direct link to a dump of the imported and converted MySQL database</a> that I put up on S3 if you prefer not to deal with that. It&#39;s for the 2015 state code with a last modified listed as June 2015.</p>
<p>The Elasticsearch index can be imported with <code>Section.import</code>.</p>
<h3 id="heroku">Heroku</h3>
<p>The database can be converted to Postgres for easy installation on Heroku. One option is to dump the database and convert with <a href="https://github.com/lanyrd/mysql-postgresql-converter">Lanyrd&#39;s MySQL to PostgreSQL conversion script</a>.</p>
<ul>
<li><code>mysqldump --compatible=postgresql --default-character-set=utf8 -r calaws.mysql -u root capublic</code></li>
<li><code>python dbconverter.py calaws.mysql calaws.psql</code></li>
</ul>
<p>It can be loaded from a local dump with <code>heroku pg:psql &lt; db-dumps/calaws.psql</code>. You&#39;ll likely need to comment out the creation of the <code>schema_migrations</code> table.</p>
<p>Populate Elasticsearch with <code>heroku run bundle exec rake environment elasticsearch:import:model CLASS=&#39;Section&#39; FORCE=true</code>.</p>
<h2 id="next-steps">Next steps</h2>
<p>Things that can be done next:</p>
<ul>
<li>Build a UI so it can be browsed online as an alternative to the official <a href="http://leginfo.legislature.ca.gov/faces/codes.xhtml">California Legislative Information</a> site.</li>
<li>Automate updates with the latest laws. This would be downloading from FTP, converting, and uploading.</li>
</ul>

</body></html>
